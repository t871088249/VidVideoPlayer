!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videoCreator=t(e.$)}(this,(function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=t(e);function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=c(e);if(t){var o=c(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return d(this,i)}}var v=function(){function e(){n(this,e),this.eventMap={}}return r(e,[{key:"on",value:function(e,t){if("function"!=typeof t)return!1;this.eventMap[e]||(this.eventMap[e]=[]),this.eventMap[e].push(t)}},{key:"off",value:function(e,t){"function"==typeof t&&(this.eventMap[e]=this.eventMap[e].filter((function(e){return e!=t})))}},{key:"once",value:function(e,t){var i=this;this.on(e,(function n(o){for(var r=arguments.length,l=new Array(r>1?r-1:0),a=1;a<r;a++)l[a-1]=arguments[a];t.apply(o,l),i.off(e,n)}))}},{key:"emit",value:function(e){for(var t=this,i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];this.eventMap[e]&&this.eventMap[e].forEach((function(e){e.apply(t,n)}))}}]),e}(),p=function(e){a(i,e);var t=f(i);function i(e){var o,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n(this,i),(o=t.call(this)).vid=e,o.on("ready",(function(){i.videoCollections.push(u(o))})),o.on("play",(function(){r&&i.stopOtherVideo(o.vid)})),o}return r(i,[{key:"pause",value:function(){}},{key:"play",value:function(){}}]),i}(v);l(p,"videoCollections",[]),l(p,"stopOtherVideo",(function(e){p.videoCollections.forEach((function(t){t.vid!=e&&t.pause()}))}));var h=function(e){a(o,e);var t=f(o);function o(e){var r;n(this,o),(r=t.call(this,e.vid,e.playStopOther)).option=e,r.v=null;var l=document.createElement("style");return console.log(i.default),l.innerHTML=[".txp_poster {background-size: contain !important;}"].join(""),i.default("head").append(l),e&&(r.container=i.default("#"+e.selector),r.option=e,r.initUserEvent(),r.init(),r.initPlayerEvent()),r}return r(o,[{key:"initUserEvent",value:function(){for(var e in this.option.events)this.option.events.hasOwnProperty(e)&&this.on(e,this.option.events[e])}},{key:"initPlayerEvent",value:function(){var e=this,t=this.v,i=this.container,n=function(){i.append('<svg class="video_icon" viewBox="0 0 100 100" style="position: absolute; z-index: 3; width: 60px; height: 60px; top: 50%; left: 50%; margin-left: -30px; margin-top: -50px">  <circle cx="50" cy="50" r="50" style="fill:#222;fill-opacity:0.75"></circle>   <path transform="translate(36, 33)" d="M0.6,2C0.6,2,0,3.5,0,16.9C0,30.3,0.6,32,0.6,32c0,1.5,1.6,2.5,2.9,1.8c0,0,3-0.5,15.2-6.6c12.2-6.1,14.2-8.4,14.2-8.4c1.5-0.7,1.5-2.8,0-3.6c0,0-3.3-3.1-14.2-8.6C7.9,1.1,3.5,0.2,3.5,0.2C2.1-0.5,0.6,0.5,0.6,2z" style="   fill:#fff;"></path></svg>'),i.find(".video_icon").on("click",(function(){i.find(".video_icon").hide(),e.play()}))},o=function(e){t.on("timeupdate",(function(e){var t=e.currentTime;void 0===t&&(t=this.v.getCurrentTime());try{this.emit("timeupdate",vid,t)}catch(e){}}))};t.getPlayerState&&(this.emit("ready"),"pc"==device&&n(),o()),this.on("play",(function(){i.find(".video_icon").hide()})),this.on("pause",(function(){i.find(".video_icon").show()})),t.on("ready",(function(){e.emit("ready"),"pc"==device&&n();var t=e.v.getPoster();i.find(".txp_poster").html('<div style="overflow: hidden;"><img style="-webkit-filter:blur(10px);-moz-filter:blur(10px);-o-filter:blur(10px);-ms-filter:blur(10px);filter:blur(10px);width: 100%; height: 100%" src="'+t+'"></div> <img style="position: absolute; top: 0;width: 100%; height: 100%; left: 0;object-fit: contain" src="'+t+'">')})),o(),t.on("volumeChange",(function(t){e.emit("volumeChange",t)})),t.on("vidChange",(function(t){e.emit("vidChange",option)})),t.on("playStateChange",(function(t){var i=t;switch("number"!=typeof i&&(i=i.state),i){case 0:e.emit("end");break;case 1:e.emit("play");break;case 2:e.emit("pause");break;case 3:e.emit("loading")}})),t.on("error",(function(e){this.emit("error",e)}))}},{key:"init",value:function(){var e=this.option,t=e.selector,i=e.poster,n=e.vid,o=e.autoplay;this.v=new Txplayer({containerId:t,vid:n,width:"100%",height:"100%",poster:i,autoplay:o})}},{key:"pause",value:function(){var e;null==this||null===(e=this.v)||void 0===e||e.pause()}},{key:"play",value:function(){var e;null==this||null===(e=this.v)||void 0===e||e.play()}},{key:"getCurrentTime",value:function(){return this.v.getCurrentTime()}},{key:"getTotalTime",value:function(){return this.v.getDuration()}},{key:"seekTo",value:function(e){isNaN(e)||this.v.seekTo(e)}}]),o}(p);function y(e){document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.webkitFullScreen||document.msFullScreen?function(){var e=window.document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitCancelFullScreen&&e.webkitCancelFullScreen()}():e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen()}var m=function(e){a(o,e);var t=f(o);function o(e){var i;if(n(this,o),i=t.call(this,e.vid,e.playStopOther),void 0===e.client_id)throw new Error("client_id is required!");return i.video_option={vid:e.vid,styleid:"0",client_id:e.client_id,newPlayer:!0},e.poster&&(i.video_option.poster=e.poster),e.autoplay&&(i.video_option.autoplay=e.autoplay),i.initUserEvent(e),i.init(e),i}return r(o,[{key:"initUserEvent",value:function(e){for(var t in e.events)e.events.hasOwnProperty(t)&&this.on(t,e.events[t])}},{key:"init",value:function(e){var t=this,n=this,o=e.selector,r=e.autoplay;this.video_option.events={onPlayerReady:function(){if(t.emit("ready"),r)try{setTimeout((function(){n.play()}),600)}catch(e){console.log(e)}i.default("video").attr({"webkit-playsinline":"playsinline","x-webkit-airplay":"allow",playsinline:"true","x5-playsinline":"true","x5-video-player-type":"h5-page","x5-video-player-fullscreen":"true"});var e=i.default(t.v.select._h5player.playerCon);if(t.v.select._poster){var l=e.find(".x-video-poster");l.css("object-fit","contain"),l.html('<div style="overflow: hidden;"><img style="-webkit-filter:blur(10px);-moz-filter:blur(10px);-o-filter:blur(10px);-ms-filter:blur(10px);filter:blur(10px);" src="'+n.v.select._poster+'"></div> <img style="position: absolute; top: 0; left: 0;object-fit: contain" src="'+t.v.select._poster+'">')}YKP.isPC||(i.default("#"+o).on("mouseover",(function(){i.default("#"+o).find(".x-video-title,.x-gradient,.x-dashboard .x-console-wrap").show()})),i.default("#"+o).on("mouseleave",(function(){i.default("#"+o).find(".x-video-title,.x-gradient,.x-dashboard .x-console-wrap").hide()})),i.default("#"+o).on("click",".i_play",(function(){t.pause()})),i.default("#"+o).on("click",".i_pause",(function(){t.play()})),i.default("#"+o).on("click",".i_fscreen",(function(){try{y(i.default("#"+o).find(".ykplayer")[0])}catch(e){console.log(e)}})),i.default("#"+o).on("mousedown",".seek-btn",(function(e){var n=t.getCurrentTime(),r=t.v.totalTime(),l=i.default("#"+o).find(".x-progress-track").width(),a=n/r*l,c=e.clientX,s=e.clientX;i.default("#"+o).find(".x-prompt").show();var u=n,d=function(e){s=e.clientX;var t=a+(s-c);t<0&&(t=0),t>l&&(t=l),i.default("#"+o).find(".x-progress-play").css("width",t);var n=(u=Math.floor(t/l*r))%60,d=Math.floor(u/60);i.default("#"+o).find(".x-current").html("".concat(d,":").concat(n))};i.default(window).on("mousemove",d),i.default(window).on("mouseup",(function e(){i.default(window).off("mousemove",d),i.default(window).off("mouseup",e),i.default("#"+o).find(".x-prompt").hide(),t.seekTo(u)}))})),t.on("timeupdate",(function(e,n){var r=(n/t.v.totalTime()*100).toFixed(2);i.default("#"+o).find(".x-progress-play").css("width",r+"%")})))},onPlay:function(){t.emit("play")},onPause:function(){t.emit("pause")},onTimeupdate:function(e){t.emit("timeupdate",t.vid,e)},onPlayEnd:function(){t.emit("end")},onError:function(e){t.emit("error",e)}},this.v=new YKU.Player(o,this.video_option)}},{key:"seekTo",value:function(e){isNaN(e)||this.v.seekTo(e)}},{key:"play",value:function(){this.v.playVideo()}},{key:"pause",value:function(){this.v.pauseVideo()}},{key:"getTotalTime",value:function(){return this.v.totalTime()}},{key:"getCurrentTime",value:function(){return this.v.currentTime()}}]),o}(p);console.log(i.default);var g=function(e){a(o,e);var t=f(o);function o(e){var i;if(n(this,o),(i=t.call(this,e.vid,e.playStopOther)).option=e,void 0===e.client_id)throw new Error("client_id is required!");return i.video_option={vid:e.vid,styleid:"0",client_id:e.client_id,newPlayer:!0},e.poster&&(i.video_option=e.poster),i.initUserEvent(e),i.initPcEvent(e),i.init(e),i}return r(o,[{key:"initUserEvent",value:function(e){for(var t in e.events)e.events.hasOwnProperty(t)&&this.on(t,e.events[t])}},{key:"initPcEvent",value:function(){window.addEventListener("message",(function(e){var t=e.data;switch(t.msg){case"onPlayerStart":video_control.changeStatus("onPlayerStart",video_control.vid);break;case"onPlayEnd":video_control.changeStatus("end",video_control.vid);break;case"onTimeUpdate":video_control.changeStatus("timeupdate",video_control.vid,t.time);break;case"state":var i=t.stateParam;"play"==i&&video_control.changeStatus("play",video_control.vid),"pause"==i&&video_control.changeStatus("pause",video_control.vid)}}),!1)}},{key:"init",value:function(e){var t=this;console.log(i.default,e),this.selector=i.default("#"+e.selector),function(e,t){if(console.log(e),"static"==e.css("position")&&e.css("position","relative"),t){var i='<div class="video_poster" style="overflow: hidden; width: 100%;height: 100%"><div style="overflow: hidden; width: 100%;height: 100%">\n                    <img style="width: 100%; height: 100%; object-fit: cover;background: #000;'.concat(blur_str,'" src="').concat(t,'">\n                </div>\n                <img style="width: 100%; height: 100%; object-fit: contain;position: absolute; left: 0 ; top:0" src="').concat(t,'">\n            </div>\n            ');e.append('<svg class="video_icon" viewBox="0 0 100 100" style="position: absolute; z-index: 1; width: 60px; height: 60px; top: 50%; left: 50%; margin-left: -30px; margin-top: -50px">  <circle cx="50" cy="50" r="44" style="fill:#222;fill-opacity:0.75"></circle>   <path transform="translate(36, 33)" d="M0.6,2C0.6,2,0,3.5,0,16.9C0,30.3,0.6,32,0.6,32c0,1.5,1.6,2.5,2.9,1.8c0,0,3-0.5,15.2-6.6c12.2-6.1,14.2-8.4,14.2-8.4c1.5-0.7,1.5-2.8,0-3.6c0,0-3.3-3.1-14.2-8.6C7.9,1.1,3.5,0.2,3.5,0.2C2.1-0.5,0.6,0.5,0.6,2z" style="   fill:#fff;"></path></svg>'),e.append(i)}else e.append('<div class="video_poster_null" style="width: 100%; height: 100%;position: absolute; z-index: 100;left: 0 ; top: 0; cursor: pointer " ></div>')}(this.selector,e.poster),e.poster||this.play(),this.selector.on("click",".video_poster, svg, .video_poster_null",(function(){t.selector.find(".video_poster_null").hide(),t.play()})),this.selector.on("click",".video_poster_null",(function(){t.video_option.autoplay=!0,t.play()})),this.on("play",(function(){t.option.poster&&t.selector.find(".video_icon,.video_poster").fadeOut()}))}},{key:"seekTo",value:function(){return console.error("优酷PC版视频该接口无法调用"),-1}},{key:"play",value:function(){this.selector.find("iframe").remove(),console.log(this),this.v=new YKU.Player(this.option.selector,this.video_option)}},{key:"pause",value:function(){}},{key:"getCurrentTime",value:function(){return console.error("优酷PC版视频该接口无法调用"),-1}}]),o}(p);function _(e){return YKP.isPC=!1,YKP.isPC?new g(e):new m(e)}var w=function(e){a(o,e);var t=f(o);function o(e,r){var l;return n(this,o),(l=t.call(this)).trigger=i.default(e),l.selector=r,l.needUserPlay=!1,l.init(),l}return r(o,[{key:"init",value:function(){var e=this,t=window.innerWidth>1008?1008:window.innerWidth,n=9*t/16;if(0==i.default(".video_player_dialog").length){var o="width: ".concat(t,"px;height: ").concat(n,"px;margin-left: -").concat(t/2,"px;margin-top: -").concat(n/2,"px;"),r='<div class="video_player_dialog" >\n                    <div class="close" >x</div>\n                    <div class="video_creator_dialog_video" style="'.concat(o,'">\n                        <div class="video_create_dialog_el" style="width: 100%; height: 100%"></div>\n                    </div>\n                </div>');i.default("body").append(r),i.default(".video_player_dialog").on("click",".close",(function(){e.hide()}))}i.default(this.trigger).on("click",(function(){i.default(".video_create_dialog_el").attr("id")!=e.selector&&i.default(".video_player_dialog").find(".video_create_dialog_el").children().remove(),e.show(),i.default(".video_create_dialog_el").attr("id")!=e.selector&&(i.default(".video_player_dialog").find(".video_create_dialog_el").attr("id",e.selector),e.needUserPlay=!1,e.emit("creatVideo"))}))}},{key:"show",value:function(){var e=this;i.default(".video_player_dialog").fadeIn((function(){e.emit("show"),e.needUserPlay=!0}))}},{key:"hide",value:function(){var e=this;i.default(".video_player_dialog").fadeOut((function(){e.emit("hide")}))}}]),o}(v);var k={vid:"",vid_from:"",dialogPlayer:!1,playStopOther:!0,events:{}},b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.option=Object.assign({},k,t);var i=this.option,o=i.selector,r=i.vid,l=i.vid_from;return o?r?l?(this.videoItem=null,void this.init()):(console.error("option.vid_from is required!"),!1):(console.error("option.vid is required!"),!1):(console.error("option.selector is required!"),!1)}return r(e,[{key:"init",value:function(){var e=this,t=this.option,i=t.selector;t.vid;var n,o=t.vid_from,r=t.dialogPlayer;t.client_id,r?(this.dialog=(n=this.option.trigger,new w(n,i)),this.dialog.on("creatVideo",(function(){e.option.autoplay=!0,"yk"==o&&(e.videoItem=_(e.option)),"tx"==o&&(e.videoItem=new h(e.option))})),this.dialog.on("show",(function(){e.dialog.needUserPlay&&e.play()})),this.dialog.on("hide",(function(){e.pause()}))):("yk"==o&&(this.videoItem=_(this.option)),"tx"==o&&(this.videoItem=new h(this.option)))}},{key:"pause",value:function(){this.videoItem.pause()}},{key:"seekTo",value:function(e){isNaN(e)||this.videoItem.seekTo(e)}},{key:"play",value:function(){this.videoItem.play()}},{key:"getCurrentTime",value:function(){return this.videoItem.getCurrentTime()}},{key:"on",value:function(e,t){if(this.option.dialogPlayer)return"请使用option.events";this.videoItem.on(e,t)}},{key:"off",value:function(e,t){this.videoItem.off(e,t)}},{key:"emit",value:function(e){for(var t,i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];(t=this.videoItem).emit.apply(t,[e].concat(n))}},{key:"once",value:function(e,t){if(this.option.dialogPlayer)return"请使用option.events";this.videoItem.once(e,t)}}]),e}();return b}));
//# sourceMappingURL=videoCreator.js.map
